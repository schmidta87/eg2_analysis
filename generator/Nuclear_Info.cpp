#include "Nuclear_Info.h"

#include "constants.h"

#include <iostream>
#include <cstdlib>

Nuclear_Info::Nuclear_Info(int thisA)
{
  A = thisA;
  fill_arrays();

  if (A==2)
    {
      sigmaCM=0.;
      Cpp0=0.;
      Cpn0=0.;
      Cpn1=4.;
      mA=m_2H;
      mAm2=0.;
    }
  else if (A==4)
    {
      //sigmaCM=0.;
      //Cpp0=0.;
      //Cpn0=0.;
      //Cpn1=16.0;
      //mA=m_2H;
      //mAm2=m_2H;

      sigmaCM=0.1;
      Cpp0=0.65;
      Cpn0=0.69;
      Cpn1=12.3;
      mA=m_4He;
      mAm2=m_2H;
    }
  else if (A==12)
    {
      //sigmaCM=0.;
      //Cpp0 = 0.;
      //Cpn0 = 0.;
      //Cpn1 = 16.;
      //mA = m_12C;
      //mAm2 = m_10B;

      sigmaCM=0.15;
      Cpp0 = 1.3;
      Cpn0 = 1.4;
      Cpn1 = 16.8;
      mA = m_12C;
      mAm2 = m_10B;
    }
  else
    {
      std::cerr << "You selected a nucleus with A=" << A << "\n"
	   << " which is not in the library. Aborting...\n";
      exit(-2);
    }
}

Nuclear_Info::~Nuclear_Info()
{
}

double Nuclear_Info::get_mA()
{
  return mA;
}

double Nuclear_Info::get_mAm2()
{
  return mAm2;
}

double Nuclear_Info::get_sigmaCM()
{
  return sigmaCM;
}

double Nuclear_Info::get_pp(double k_rel)
{
  return 2. * 0.5*A*Cpp0 * get_phiSq(phiSq_pp0,k_rel); // The 2 comes from contact definition
}

double Nuclear_Info::get_pn(double k_rel)
{
  return get_pn0(k_rel) + get_pn1(k_rel);
}

double Nuclear_Info::get_pn0(double k_rel)
{
  return 0.5*A*Cpn0 * get_phiSq(phiSq_pn0,k_rel);
}

double Nuclear_Info::get_pn1(double k_rel)
{
  return 0.5*A*Cpn1 * get_phiSq(phiSq_pn1,k_rel);
}

double Nuclear_Info::get_phiSq(double *phiPtr, double k_rel)
{
  double bin = k_rel / GeVfm / 0.1;

  if (bin < 0.)
    return 0.;
  if (bin < 1.)
    return bin * phiPtr[0];
  if (bin > 100.)
    return 0.;
  
  int b = bin;
  double x = bin - b;
  return x*phiPtr[b] + (1.-x)*phiPtr[b-1];
}

void Nuclear_Info::fill_arrays()
{
  double temp_pp0[100]={
18683396.6234051,
639762.771794429,
73908.4475109856,
19752.8915725184,
6985.74841560849,
2883.66695171470,
1311.78054811353,
635.881495153820,
321.191776313180,
166.247451460222,
86.9438198909215,
45.3289533225080,
23.2131420726046,
11.4576914568038,
5.29974612988386,
2.18689765695214,
0.723732923792566,
0.137896096570853,
4.12685844627030e-05,
0.0727158808737714,
0.226901073028930,
0.395063240611470,
0.544381242558901,
0.661344392334904,
0.742861516856787,
0.791143734434978,
0.810792168659347,
0.807178799717402,
0.785584610798292,
0.750777638541285,
0.706842253126365,
0.657147414337408,
0.604387561560645,
0.550657368958016,
0.497538209703937,
0.446184204150935,
0.397401619319003,
0.351718915091108,
0.309446692517894,
0.270727876691614,
0.235579021084050,
0.203923808405533,
0.175619887900554,
0.150480111027402,
0.128289127363092,
0.108816186511540,
0.0918248549792178,
0.0770802581221853,
0.0643543427291766,
0.0534295732034895,
0.0441013995568204,
0.0361797665632472,
0.0294898887833488,
0.0238724658630861,
0.0191834816190184,
0.0152937004965316,
0.0120879498074588,
0.00946426056443420,
0.00733292073493141,
0.00561548499534776,
0.00424377382159058,
0.00315888638862199,
0.00231024647415919,
0.00165469372492237,
0.00115562981773023,
0.000782224904061435,
0.000508687260620702,
0.000313597316489482,
0.000179305093435832,
9.13894307095126e-05,
3.81761072994801e-05,
1.03115213746831e-05,
3.88175399680274e-07,
2.61789357516966e-06,
1.25486971126193e-05,
2.68211999506852e-05,
4.29605262757271e-05,
5.91998708366808e-05,
7.43320801459427e-05,
8.75857955193904e-05,
9.85230339935429e-05,
0.000106955293396467,
0.000112875544007094,
0.000116403787155677,
0.000117744015233489,
0.000117150772586753,
0.000114903644185344,
0.000111288261107098,
0.000106582623299399,
0.000101047641953342,
9.49210697898548e-05,
8.84140257395268e-05,
8.17095142128591e-05,
7.49624331697077e-05,
6.83006230706950e-05,
6.18266636168423e-05,
5.56201120806382e-05,
4.97400019576200e-05,
4.42274383700330e-05,
3.91081590235919e-05 };
  
  double temp_pn0[100]={
    15300347.6134154,
605303.564201820,
73834.3503740097,
19878.2097394933,
7079.24825845492,
2944.09198372589,
1349.97657879891,
660.122202477167,
336.728804141499,
176.298704218147,
93.4845047260791,
49.5886951870085,
25.9714168385921,
13.2178860083239,
6.39260311945783,
2.83299355960728,
1.07195373878876,
0.289625746873957,
0.0246844530122985,
0.0178583062118798,
0.125082288431188,
0.268366005728782,
0.407585843596093,
0.524122463013246,
0.611316245840212,
0.668898684124935,
0.699764403042386,
0.708128892239602,
0.698507640769719,
0.675180174807435,
0.641937252769538,
0.601989917922953,
0.557967692823637,
0.511962616755094,
0.465593717446985,
0.420077426590986,
0.376295990718513,
0.334859908218734,
0.296162721663445,
0.260427816755645,
0.227747609785500,
0.198115831807818,
0.171453776490820,
0.147631376716036,
0.126483928292068,
0.107825202141938,
0.0914575815220566,
0.0771797811605364,
0.0647926089294318,
0.0541031584298509,
0.0449277547493419,
0.0370939135546064,
0.0304415320756220,
0.0248234844428549,
0.0201057640952047,
0.0161672877188262,
0.0128994510382827,
0.0102055111519582,
0.00799985200444371,
0.00620717943986927,
0.00476168126061856,
0.00360617928917502,
0.00269129482205885,
0.00197464213155372,
0.00142006146748792,
0.000996898813714605,
0.000679337007646729,
0.000445780871960240,
0.000278296795707633,
0.000162106335125849,
8.51320544200502e-05,
3.75932352004908e-05,
1.16485714068543e-05,
1.08253163070344e-06,
1.03199417632785e-06,
7.74959578942479e-06,
1.84003059687360e-05,
3.08877976502499e-05,
4.37073532356883e-05,
5.58221914364596e-05,
6.65603459094842e-05,
7.55294202452235e-05,
8.25467753782413e-05,
8.75829716572109e-05,
9.07164467431434e-05,
9.20977102440348e-05,
9.19214729919702e-05,
9.04053578688611e-05,
8.77740288782096e-05,
8.42476860300348e-05,
8.00340987383894e-05,
7.53234078245167e-05,
7.02850949857751e-05,
6.50666109491192e-05,
5.97932169009648e-05,
5.45687270792788e-05,
4.94768459445548e-05,
4.45829003113426e-05,
3.99357918975429e-05,
3.55700295210602e-05 };

 double temp_pn1[100]={
9719347.01980097,
318593.292678900,
22749.3998006928,
6401.62362578146,
2348.52221536720,
1009.39011304670,
480.992840533724,
246.667535493963,
133.815565263115,
76.0204380885667,
44.9698215549149,
27.6256104398493,
17.6113651545925,
11.6554909395860,
8.01265456085003,
5.72141474729729,
4.23766865489032,
3.24648817294686,
2.56196536296042,
2.07249436009417,
1.71001251328634,
1.43240940954246,
1.21323306249160,
1.03560664263678,
0.888560402592821,
0.764807843162692,
0.659386766232806,
0.568808616443671,
0.490541162045559,
0.422675899627828,
0.363724250528384,
0.312484667341479,
0.267962662929490,
0.229313012167132,
0.195808646790267,
0.166814491586681,
0.141772688832050,
0.120190610300630,
0.101632335812215,
0.0857119717105394,
0.0720878567712070,
0.0604582089317134,
0.0505566821510119,
0.0421488714416281,
0.0350288866094745,
0.0290163933649339,
0.0239537816252370,
0.0197037456548734,
0.0161468712195542,
0.0131797264665244,
0.0107128045439877,
0.00866898998945952,
0.00698195608662072,
0.00559481879189304,
0.00445896436216796,
0.00353291789332953,
0.00278145326361891,
0.00217468992210455,
0.00168740683628140,
0.00129835696471829,
0.000989711865063592,
0.000746569317164056,
0.000556510241080911,
0.000409234833246501,
0.000296231028763088,
0.000210498717808956,
0.000146307967366238,
9.89919969516571e-05,
6.47728839110443e-05,
4.06093558895128e-05,
2.40706216722095e-05,
1.32278775917788e-05,
6.56367236603606e-06,
2.89543259446484e-06,
1.31177412220194e-06,
1.11918172661823e-06,
1.79836347095379e-06,
2.96751602061125e-06,
4.35308361161955e-06,
5.76499805329840e-06,
7.07765842414418e-06,
8.21354735367137e-06,
9.13114216166253e-06,
9.81469684998417e-06,
1.02666161123944e-05,
1.05013207681944e-05,
1.05407977677218e-05,
1.04111806786600e-05,
1.01400550619744e-05,
9.75498447394318e-06,
9.28203776880245e-06,
8.74513113628124e-06,
8.16560816526371e-06,
7.56192611136283e-06,
6.94975966207589e-06,
6.34202745021571e-06,
5.74905425138788e-06,
5.17892680624413e-06,
4.63757174402013e-06,
4.12921363490272e-06 };

  for (int i=0 ; i<100; i++)
    {
      phiSq_pp0[i] = temp_pp0[i];
      phiSq_pn0[i] = temp_pn0[i];
      phiSq_pn1[i] = temp_pn1[i];
    }
}
